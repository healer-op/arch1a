<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ArchiaAi | Admin</title>
  <meta name="description" content="Generate fully SEO-optimized blog posts for ArchiaStudio automatically.">
  <link rel="stylesheet" href="../../../warehouse/css/warehouse.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <link rel="icon" href="../../../warehouse/data/images/icon.png" sizes="32x32">

  <style>
body {
    font-family: Causten-ExtraBold, sans-serif;
    background: #000; /* fallback before script fade loads */
    color: #222;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    overflow: hidden;
    transition: background 2s ease-in-out;
  }

  .hidden {
    display: none !important;
  }

  /* üåà Main Panels (centered glass boxes) */
  #password-screen,
  #main-screen {
    width: 100%;
    max-width: 800px;
    text-align: center;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow:
      0 8px 32px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.5),
      inset 0 -1px 0 rgba(255, 255, 255, 0.1),
      inset 0 0 20px 10px rgba(255, 255, 255, 1);
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    overflow: hidden;
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.8),
      transparent,
      rgba(255, 255, 255, 0.3)
    );
    padding: 40px;
    transition: opacity 0.8s ease-in-out, transform 0.8s ease-in-out;
  }

  #password-screen.hidden,
  #main-screen.hidden {
    opacity: 0;
    pointer-events: none;
  }

  #password-screen:not(.hidden),
  #main-screen:not(.hidden) {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }

  /* üñã Inputs */
  input {
    width: 90%;
    padding: 12px 14px;
    margin: 10px 0;
    border-radius: 10px;
    border: 1px solid rgba(200, 200, 200, 0.6);
    font-size: 16px;
    outline: none;
    background: rgba(255, 255, 255, 0.8);
    transition: all 0.3s ease;
  }

  input:focus {
    border-color: #4caf50;
    box-shadow: 0 0 10px rgba(102, 190, 0, 0.3);
    background: rgba(255, 255, 255, 1);
  }

  /* üöÄ Buttons */
  button {
    background: #66be00;
    color: #fff;
    border: none;
    padding: 12px 20px;
    border-radius: 10px;
    cursor: pointer;
    margin: 5px;
    font-family: inherit;
    font-size: 16px;
    transition: all 0.3s ease-in-out;
  }

  button:hover {
    background: #2e9800;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(46, 152, 0, 0.4);
  }

  /* üñº Image Preview */
  img#preview {
    max-width: 50%;
    margin-top: 15px;
    border-radius: 10px;
    transition: transform 0.3s ease, opacity 0.5s ease;
  }

  img#preview:hover {
    transform: scale(1.02);
  }

  /* ‚úÖ Status Text */
  #status {
    margin-top: 20px;
    font-weight: bold;
    color: green;
  }

  /* üì± Responsive */
  @media (max-width: 768px) {
    #password-screen,
    #main-screen {
      width: 90%;
      padding: 25px;
    }

    input,
    button {
      font-size: 14px;
    }
  }
  </style>
</head>

<body>

  <!-- üîí Password Screen -->
  <div id="password-screen">
    <img src="../../../warehouse/data/images/archiaai.png">
    <br>
    <h2>Enter Password to Access Blog Generator</h2>
    <br><br>
    <input type="password" id="password-input" placeholder="Enter password" />
    <br><br>
    <button onclick="checkPassword()" style="width: 80%;">Unlock</button>
    <p id="error" style="color:red; display:none;">Incorrect password!</p>
  </div>

  <!-- ‚ú® Main Generator -->
  <div id="main-screen" class="hidden">
    <img src="../../../warehouse/data/images/archiaai.png">
    <input id="title" placeholder="Enter Blog Title (leave blank to auto-generate)" />
    <input id="imageUrl" placeholder="Enter custom image URL (optional)" />
    <div>
      <button id="generate-topic"
        style="background: linear-gradient(90deg,rgba(131, 58, 180, 1) 0%, rgba(253, 29, 29, 1) 50%, rgba(252, 176, 69, 1) 100%);width: 20%;">üéØ
        Generate Title</button>
      <button id="generate-blog" style="width: 70%;">üöÄ Generate Blog</button>
    </div>
    <img id="preview" src="" class="hidden" alt="Image Preview">
    <div id="status"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script>
  const backgrounds = [
    "https://i.pinimg.com/1200x/f8/6a/e7/f86ae763a92a096279d5de6388f6bce0.jpg",
    "https://i.pinimg.com/1200x/4c/f4/b6/4cf4b6355fe44656184cab80d5d86d7a.jpg",
    "https://i.pinimg.com/1200x/ae/5b/b6/ae5bb62113de99a56e2affb1d93d96f5.jpg",
    "https://i.pinimg.com/1200x/64/63/43/64634350f9161a8c5bba4fb09f873fa5.jpg",
    "https://i.pinimg.com/1200x/df/a0/93/dfa093f4376b1402f8a9b09ae9223405.jpg",
  ];

  let bgIndex = 0;

  // üñº Create two layered background divs for smooth transition
  const bg1 = document.createElement("div");
  const bg2 = document.createElement("div");
  [bg1, bg2].forEach(bg => {
    bg.style.position = "fixed";
    bg.style.top = 0;
    bg.style.left = 0;
    bg.style.width = "100%";
    bg.style.height = "100%";
    bg.style.backgroundSize = "cover";
    bg.style.backgroundPosition = "center";
    bg.style.transition = "opacity 2.5s ease-in-out";
    bg.style.zIndex = "-1";
  });

  bg1.style.backgroundImage = `url(${backgrounds[0]})`;
  bg1.style.opacity = "1";
  bg2.style.opacity = "0";

  document.body.appendChild(bg1);
  document.body.appendChild(bg2);

  setInterval(() => {
    bgIndex = (bgIndex + 1) % backgrounds.length;
    const next = backgrounds[bgIndex];

    if (bg1.style.opacity === "1") {
      bg2.style.backgroundImage = `url(${next})`;
      bg2.style.opacity = "1";
      bg1.style.opacity = "0";
    } else {
      bg1.style.backgroundImage = `url(${next})`;
      bg1.style.opacity = "1";
      bg2.style.opacity = "0";
    }
  }, 8000);
</script>
  <script>
    const API_BASE = "https://seo-blog-generator.healerzee51.workers.dev";
    const PASSWORD = "aGVhbGVyIzMyMTE=";
    const UNSPLASH_KEY = "P0wLQEty9GltY1gkYLlhO-NyvjNvdeuuk575NiOdI-g";

    // üîê Password Protection
    function checkPassword() {
      const pass = document.getElementById("password-input").value;
      if (pass === atob(PASSWORD)) {
        document.getElementById("password-screen").classList.add("hidden");
        document.getElementById("main-screen").classList.remove("hidden");
        Toastify({ text: "‚úÖ Access granted", backgroundColor: "linear-gradient(to right, #00b09b, #96c93d)" }).showToast();
      } else {
        document.getElementById("error").style.display = "block";
        Toastify({ text: "‚ùå Incorrect password!", backgroundColor: "linear-gradient(to right, #ff416c, #ff4b2b)" }).showToast();
      }
    }

    // üéØ Generate a Topic
    document.getElementById("generate-topic").onclick = async () => {
      const status = document.getElementById("status");
      status.innerText = "‚ú® Generating topic...";
      try {
        const res = await fetch(`${API_BASE}/api/generate-topic`);
        if (!res.ok) throw new Error("Failed to generate topic");
        const data = await res.json();
        const topic = data.topic || data.title || data.idea || "Untitled Blog";
        document.getElementById("title").value = topic;
        status.innerText = `‚úÖ Topic generated: ${topic}`;
        Toastify({ text: "üéØ Topic generated successfully!", backgroundColor: "linear-gradient(to right, #00b09b, #96c93d)" }).showToast();
      } catch (err) {
        console.error(err);
        status.innerText = "‚ùå Failed to fetch topic.";
        Toastify({ text: "‚ùå Failed to fetch topic", backgroundColor: "linear-gradient(to right, #ff416c, #ff4b2b)" }).showToast();
      }
    };

    // üöÄ Generate Blog
    document.getElementById("generate-blog").onclick = async () => {
      let title = document.getElementById("title").value.trim();
      let imageUrl = document.getElementById("imageUrl").value.trim();
      const status = document.getElementById("status");

      try {
        if (!title) {
          status.innerText = "‚ú® No title ‚Äî auto-generating one...";
          const res = await fetch(`${API_BASE}/api/generate-topic`);
          const data = await res.json();
          title = data.topic || data.title || "Untitled Blog";
          document.getElementById("title").value = title;
        }

        status.innerText = "üñº Fetching image...";
        if (!imageUrl) {
          const unsplash = await fetch(
            `https://api.unsplash.com/photos/random?query=${encodeURIComponent(title)}&client_id=${UNSPLASH_KEY}`
          );
          const data = await unsplash.json();
          imageUrl = data.urls?.regular ||
            "https://i.pinimg.com/1200x/4e/ba/3a/4eba3a4cb7b18d54f4b40d2e95ce5071.jpg";
        }

        const preview = document.getElementById("preview");
        preview.src = imageUrl;
        preview.classList.remove("hidden");

        status.innerText = "‚öôÔ∏è Generating full blog via AI...";
        Toastify({ text: "‚öôÔ∏è Generating blog...", backgroundColor: "linear-gradient(to right, #56ccf2, #2f80ed)" }).showToast();

        const res = await fetch(`${API_BASE}/api/generate`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            password: atob(PASSWORD),
            title,
            idea: title,
            imageUrl
          })
        });

        if (!res.ok) throw new Error("Server error");
        const result = await res.json();
        if (result.error) throw new Error(result.error);

        status.innerHTML = `‚úÖ Blog generated and uploaded:<br>
          <a href="https://archiastudio.com/blog/${result.file}" target="_blank">${result.file}</a>`;
        Toastify({ text: "üöÄ Blog generated and uploaded!", backgroundColor: "linear-gradient(to right, #00b09b, #96c93d)" }).showToast();
      } catch (err) {
        console.error(err);
        status.innerText = "‚ùå Blog generation failed. Try again.";
        Toastify({ text: "‚ùå Blog generation failed!", backgroundColor: "linear-gradient(to right, #ff416c, #ff4b2b)" }).showToast();
      }
    };
  </script>
</body>

</html>
